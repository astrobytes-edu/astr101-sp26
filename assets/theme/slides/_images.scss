// =============================================================================
// IMAGES — Safe defaults + composable utilities (RevealJS)
// =============================================================================
//
// Goals:
// - Never 0×0 (even without explicit width/height)
// - Never overflow slide bounds by default
// - Provide predictable controls: contain vs cover, max size, alignment, cropping
// - Work with plain <img> output from {{< img >}} and Quarto Markdown images

// ---------------------------------------------------------------------------
// Safe defaults (apply broadly; utilities can override)
// ---------------------------------------------------------------------------

// Keep content images readable and bounded.
// NOTE: exclude slide logos (Quarto renders logo with .slide-logo / .logo variants).
.reveal .slides section img:not(.slide-logo):not(.logo) {
  display: block;
  max-width: 100%;
  height: auto;
  max-height: var(--slide-img-max-h, 72vh);
  margin-inline: auto;
  min-width: 1px;
  min-height: 1px;
}

// Avoid turning Quarto's logo into a "content image".
.reveal .slides section .slide-logo img,
.reveal .slides section .logo img,
.reveal img.slide-logo,
.reveal img.logo {
  max-height: none;
}

// Backward compatibility: legacy class used in some decks.
.reveal section img.fill-image {
  width: 100%;
  height: auto;
  object-fit: contain;
}

// ---------------------------------------------------------------------------
// Alignment utilities
// ---------------------------------------------------------------------------
.reveal .img-left { margin-left: 0 !important; margin-right: auto !important; }
.reveal .img-center { margin-inline: auto !important; }
.reveal .img-right { margin-left: auto !important; margin-right: 0 !important; }

// ---------------------------------------------------------------------------
// Sizing utilities
// ---------------------------------------------------------------------------
.reveal .img-max-40 { max-width: 40% !important; }
.reveal .img-max-60 { max-width: 60% !important; }
.reveal .img-max-80 { max-width: 80% !important; }
.reveal .img-max-100 { max-width: 100% !important; }

.reveal .img-max-50vh { max-height: 50vh !important; }
.reveal .img-max-65vh { max-height: 65vh !important; }
.reveal .img-max-75vh { max-height: 75vh !important; }

// ---------------------------------------------------------------------------
// Fit utilities (primarily useful inside .img-frame / fixed-size containers)
// ---------------------------------------------------------------------------
.reveal .img-fit-contain { object-fit: contain !important; }
.reveal .img-fit-cover { object-fit: cover !important; }

// Object position utilities (crop focal point control).
.reveal .img-pos-center { object-position: center center !important; }
.reveal .img-pos-top { object-position: center top !important; }
.reveal .img-pos-bottom { object-position: center bottom !important; }
.reveal .img-pos-left { object-position: left center !important; }
.reveal .img-pos-right { object-position: right center !important; }

// ---------------------------------------------------------------------------
// Framing utilities (wrapper-based cropping with predictable geometry)
// ---------------------------------------------------------------------------
.reveal .img-frame {
  display: block;
  width: 100%;
  max-width: 100%;
  max-height: var(--slide-img-max-h, 72vh);
  overflow: hidden;
  border-radius: $radius-sm;
  background: rgba($border-color, 0.12);
}

.reveal .img-frame > p {
  margin: 0;
  height: 100%;
}

.reveal .img-frame img {
  width: 100%;
  height: 100%;
  max-width: none;
  max-height: none;
  margin: 0;
  display: block;
}

.reveal .img-frame-16x9 { aspect-ratio: 16 / 9; }
.reveal .img-frame-4x3 { aspect-ratio: 4 / 3; }
.reveal .img-frame-square { aspect-ratio: 1 / 1; }

// If the image doesn't specify a fit mode, contain is the safer default.
.reveal .img-frame img:not(.img-fit-cover) {
  object-fit: contain;
}
