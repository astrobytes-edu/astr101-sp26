<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Seasons: Why Tilt Matters | AstroEd</title>
  <link rel="icon" type="image/svg+xml" href="../_assets/favicon.svg">
  <link rel="stylesheet" href="../_assets/astro-theme.css">
  <link rel="stylesheet" href="../_assets/demo-shell.css">
  <link rel="stylesheet" href="../_assets/demo-legacy.css">
  <style>
    :root {
      --demo-max-width: 1200px;
    }

    /* Two-panel layout for orbital and globe views */
    .viz-layout {
      display: grid;
      grid-template-columns: 1fr 1fr;
      margin-bottom: var(--space-md);
    }

    #orbital-view, #globe-view {
      width: 100%;
      height: auto;
      display: block;
    }

    /* Controls grid */
    .controls-grid {
      grid-template-columns: 1fr 1fr;
    }

    .slider-labels {
      display: flex;
      justify-content: space-between;
      font-size: var(--font-size-xs);
      color: var(--text-muted);
      margin-top: var(--space-xs);
    }

    /* Preset buttons */
    .presets-section {
      margin-top: 0.75rem;
    }

    .presets-label {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-bottom: 0.5rem;
    }

    .presets-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .preset-btn.season {
      border-color: var(--accent-blue);
    }

    .preset-btn.season:hover {
      border-color: var(--accent-blue);
      background: rgba(93, 173, 226, 0.2);
    }

    .preset-btn.season.active {
      background: var(--accent-blue);
      color: var(--space-black);
    }

    /* Readout panel */
    .readout-panel {
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    }

    .readout-value.season-summer {
      color: var(--accent-gold);
    }

    .readout-value.season-winter {
      color: var(--accent-blue);
    }

    .readout-value.season-spring,
    .readout-value.season-fall {
      color: var(--accent-green);
    }

    /* Overlay toggles */
    .overlays-section {
      margin-top: 0.75rem;
      padding-top: 0.75rem;
      border-top: 1px solid var(--border-color);
    }

    .overlays-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 0.5rem;
    }

    .overlay-toggle {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.8rem;
      color: var(--text-secondary);
      cursor: pointer;
    }

    .overlay-toggle input[type="checkbox"] {
      accent-color: var(--cosmic-teal);
      width: 16px;
      height: 16px;
      cursor: pointer;
    }

    .overlay-toggle:hover {
      color: var(--text-primary);
    }

    /* Insight box */
    .insight-box {
      background: rgba(18, 18, 31, 0.9);
      border-left: 3px solid var(--accent-blue);
      padding: 1rem;
      border-radius: 0 8px 8px 0;
      font-size: 0.9rem;
    }

    .insight-box strong {
      color: var(--accent-blue);
    }

    .insight-box .misconception {
      color: var(--accent-red);
      font-style: italic;
    }

    .model-note {
      margin-top: var(--space-md);
      background: rgba(18, 18, 31, 0.9);
      border: 1px solid var(--border-color);
      border-left: 3px solid var(--accent-gold);
      padding: 0.75rem 1rem;
      border-radius: 0 8px 8px 0;
      font-size: var(--font-size-sm);
      color: var(--text-secondary);
    }

    .model-note strong {
      color: var(--text-primary);
    }

    /* Responsive */
    @media (max-width: 800px) {
      .viz-layout {
        grid-template-columns: 1fr;
      }

      .controls-grid {
        grid-template-columns: 1fr;
      }

      .readout-panel {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 500px) {
      .readout-panel {
        grid-template-columns: 1fr;
      }

      .overlays-grid {
        grid-template-columns: 1fr;
      }
    }

    /* SVG styles */
    .orbit-path {
      fill: none;
      stroke: var(--text-muted);
      stroke-width: 1.5;
      stroke-dasharray: 6 4;
      opacity: 0.5;
    }

    .axis-line {
      stroke: #ff6b6b;
      stroke-width: 2;
    }

    .axis-arrow {
      fill: #ff6b6b;
    }

    .sunlight-ray {
      stroke: var(--sun-glow);
      stroke-width: 1.5;
      opacity: 0.6;
    }

    .terminator {
      fill: rgba(0, 0, 0, 0.5);
    }

    .latitude-line {
      fill: none;
      stroke: var(--accent-blue);
      stroke-width: 1;
      stroke-dasharray: 3 3;
      opacity: 0.5;
    }

    .latitude-line.equator {
      stroke: var(--accent-green);
      stroke-width: 1.5;
      opacity: 0.7;
    }

    .latitude-line.tropic {
      stroke: var(--accent-gold);
    }

    .latitude-line.arctic {
      stroke: var(--accent-blue);
    }

    .celestial-equator {
      fill: none;
      stroke: var(--accent-green);
      stroke-width: 1.5;
      stroke-dasharray: 8 4;
      opacity: 0.6;
    }

    .ecliptic-line {
      fill: none;
      stroke: var(--accent-gold);
      stroke-width: 1.5;
      stroke-dasharray: 4 4;
      opacity: 0.6;
    }

    .hour-grid {
      fill: none;
      stroke: var(--text-muted);
      stroke-width: 0.8;
      opacity: 0.45;
    }

    .polaris-label {
      font-size: 10px;
      fill: #ff6b6b;
    }

    .distance-label {
      font-size: 10px;
      fill: var(--text-muted);
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }
  </style>
</head>
<body>
  <div class="demo-wrapper">
    <canvas id="starfield"></canvas>

    <div class="demo-content">
      <header class="demo-header">
        <h1 class="demo-title">Seasons: Why Tilt Matters</h1>
        <p class="demo-subtitle">Axial tilt causes seasons—not distance from the Sun</p>
      </header>

      <!-- Readout panel -->
      <div class="readout-panel">
        <div class="readout-item">
          <div class="readout-label">Date</div>
          <div class="readout-value" id="date-display">March 21</div>
        </div>
        <div class="readout-item">
          <div class="readout-label">Season (North)</div>
          <div class="readout-value" id="season-north-display">Spring</div>
        </div>
        <div class="readout-item">
          <div class="readout-label">Season (South)</div>
          <div class="readout-value" id="season-south-display">Fall</div>
        </div>
        <div class="readout-item">
          <div class="readout-label">Day Length</div>
          <div class="readout-value" id="day-length-display">12h 0m</div>
        </div>
        <div class="readout-item">
          <div class="readout-label">Sun Altitude</div>
          <div class="readout-value" id="sun-altitude-display">50.0°</div>
        </div>
        <div class="readout-item">
          <div class="readout-label">Earth-Sun Distance</div>
          <div class="readout-value" id="distance-display">0.997 AU</div>
        </div>
      </div>

      <!-- Two-view visualization -->
      <div class="viz-layout">
        <!-- Orbital View (top-down) -->
        <div class="viz-panel">
          <div class="panel-title">Orbital View</div>
          <svg id="orbital-view" viewBox="0 0 400 400" preserveAspectRatio="xMidYMid meet">
            <defs>
              <radialGradient id="sunGlowGradient">
                <stop offset="0%" stop-color="#fff5cc"/>
                <stop offset="40%" stop-color="#ffcc00"/>
                <stop offset="100%" stop-color="#ff8c00"/>
              </radialGradient>
              <radialGradient id="earthDayGradient" cx="30%" cy="30%">
                <stop offset="0%" stop-color="#6bb5e0"/>
                <stop offset="100%" stop-color="#2a5a8a"/>
              </radialGradient>
              <filter id="sunGlow" x="-50%" y="-50%" width="200%" height="200%">
                <feGaussianBlur stdDeviation="8" result="blur"/>
                <feMerge>
                  <feMergeNode in="blur"/>
                  <feMergeNode in="SourceGraphic"/>
                </feMerge>
              </filter>
            </defs>

            <!-- Earth's orbital path (slightly elliptical) -->
            <ellipse id="orbit-path" class="orbit-path" cx="200" cy="200" rx="150" ry="145"/>

            <!-- Sun at center -->
            <g id="sun-orbital" transform="translate(200, 200)">
              <circle r="30" fill="url(#sunGlowGradient)" filter="url(#sunGlow)"/>
              <text y="50" text-anchor="middle" fill="var(--text-muted)" font-size="10">Sun</text>
            </g>

            <!-- Perihelion/Aphelion markers -->
            <g id="orbital-markers" opacity="0.4">
              <circle cx="50" cy="200" r="3" fill="var(--text-muted)"/>
              <text x="50" y="220" text-anchor="middle" fill="var(--text-muted)" font-size="8">Aphelion (Jul)</text>
              <circle cx="350" cy="200" r="3" fill="var(--text-muted)"/>
              <text x="350" y="220" text-anchor="middle" fill="var(--text-muted)" font-size="8">Perihelion (Jan)</text>
            </g>

            <!-- Earth with tilted axis -->
            <g id="earth-orbital" class="earth-marker"
               role="img"
               aria-label="Earth position on orbit"
               aria-roledescription="Earth at current date position">
              <circle id="earth-orbital-circle" cx="200" cy="55" r="15" fill="url(#earthDayGradient)"/>
              <!-- Axis indicator (arrow pointing to Polaris) -->
              <g id="axis-indicator">
                <line id="axis-line" class="axis-line" x1="200" y1="55" x2="200" y2="25"/>
                <polygon id="axis-arrow" class="axis-arrow" points="200,20 196,28 204,28"/>
                <text id="polaris-label" class="polaris-label" x="200" y="15" text-anchor="middle">Polaris</text>
              </g>
              <text id="earth-label" x="200" y="80" text-anchor="middle" fill="var(--text-muted)" font-size="10">Earth</text>
            </g>

            <!-- Distance display line -->
            <g id="distance-indicator" opacity="0.5">
              <line id="distance-line" x1="200" y1="200" x2="200" y2="55" stroke="var(--text-muted)" stroke-width="1" stroke-dasharray="4 4"/>
              <text id="distance-text" class="distance-label" x="200" y="130" text-anchor="middle"></text>
            </g>

            <!-- Season labels at quadrants -->
            <g id="season-labels" font-size="10" fill="var(--text-secondary)">
              <text x="200" y="40" text-anchor="middle" id="season-label-top">March</text>
              <text x="360" y="205" text-anchor="start" id="season-label-right">June</text>
              <text x="200" y="375" text-anchor="middle" id="season-label-bottom">September</text>
              <text x="40" y="205" text-anchor="end" id="season-label-left">December</text>
            </g>
          </svg>
        </div>

        <!-- Globe View (surface perspective) -->
        <div class="viz-panel">
          <div class="panel-title">Globe View</div>
          <svg id="globe-view" viewBox="0 0 400 400" preserveAspectRatio="xMidYMid meet">
            <defs>
              <clipPath id="globe-clip">
                <circle cx="200" cy="200" r="150"/>
              </clipPath>
              <radialGradient id="globeGradient" cx="30%" cy="30%">
                <stop offset="0%" stop-color="#8ec8e8"/>
                <stop offset="50%" stop-color="#4a90d9"/>
                <stop offset="100%" stop-color="#1a4a7a"/>
              </radialGradient>
              <linearGradient id="terminatorGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" stop-color="rgba(0,0,0,0)"/>
                <stop offset="40%" stop-color="rgba(0,0,0,0.3)"/>
                <stop offset="60%" stop-color="rgba(0,0,0,0.7)"/>
                <stop offset="100%" stop-color="rgba(0,0,0,0.85)"/>
              </linearGradient>
            </defs>

            <!-- Sunlight arrows (from left) -->
            <g id="sunlight-arrows">
              <line class="sunlight-ray" x1="10" y1="100" x2="50" y2="100"/>
              <line class="sunlight-ray" x1="10" y1="150" x2="50" y2="150"/>
              <line class="sunlight-ray" x1="10" y1="200" x2="50" y2="200"/>
              <line class="sunlight-ray" x1="10" y1="250" x2="50" y2="250"/>
              <line class="sunlight-ray" x1="10" y1="300" x2="50" y2="300"/>
              <text x="30" y="80" fill="var(--sun-glow)" font-size="10" text-anchor="middle">Sunlight</text>
            </g>

            <!-- Globe background -->
            <circle id="globe-bg" cx="200" cy="200" r="150" fill="url(#globeGradient)"/>

            <!-- Globe surface group (clipped) -->
            <g clip-path="url(#globe-clip)">
              <!-- Latitude bands overlay -->
              <g id="latitude-bands">
                <!-- Arctic Circle (66.5°N) -->
                <ellipse id="arctic-circle" class="latitude-line arctic" cx="200" cy="200" rx="150" ry="20"/>
                <!-- Tropic of Cancer (23.5°N) -->
                <ellipse id="tropic-cancer" class="latitude-line tropic" cx="200" cy="200" rx="150" ry="60"/>
                <!-- Equator -->
                <ellipse id="equator-line" class="latitude-line equator" cx="200" cy="200" rx="150" ry="100"/>
                <!-- Tropic of Capricorn (23.5°S) -->
                <ellipse id="tropic-capricorn" class="latitude-line tropic" cx="200" cy="200" rx="150" ry="140"/>
                <!-- Antarctic Circle (66.5°S) -->
                <ellipse id="antarctic-circle" class="latitude-line arctic" cx="200" cy="200" rx="150" ry="20"/>
              </g>

              <!-- Celestial equator overlay (off by default) -->
              <ellipse id="celestial-equator" class="celestial-equator" cx="200" cy="200" rx="150" ry="100" style="display: none;"/>

              <!-- Ecliptic overlay (off by default) -->
              <ellipse id="ecliptic-overlay" class="ecliptic-line" cx="200" cy="200" rx="150" ry="100" style="display: none;"/>

              <!-- Day/Night terminator -->
              <ellipse id="terminator" class="terminator" cx="250" cy="200" rx="50" ry="150" fill="rgba(0,0,0,0.6)"/>

              <!-- Hour angle grid (off by default) -->
              <g id="hour-grid" style="display: none;">
                <line class="hour-grid" x1="200" y1="50" x2="200" y2="350"/>
                <line class="hour-grid" x1="200" y1="50" x2="200" y2="350" transform="rotate(30 200 200)"/>
                <line class="hour-grid" x1="200" y1="50" x2="200" y2="350" transform="rotate(60 200 200)"/>
                <line class="hour-grid" x1="200" y1="50" x2="200" y2="350" transform="rotate(90 200 200)"/>
                <line class="hour-grid" x1="200" y1="50" x2="200" y2="350" transform="rotate(120 200 200)"/>
                <line class="hour-grid" x1="200" y1="50" x2="200" y2="350" transform="rotate(150 200 200)"/>
              </g>
            </g>

            <!-- Globe edge -->
            <circle cx="200" cy="200" r="150" fill="none" stroke="var(--text-muted)" stroke-width="2" opacity="0.5"/>

            <!-- Axis through globe -->
            <g id="globe-axis">
              <line id="globe-axis-line" class="axis-line" x1="200" y1="30" x2="200" y2="370"/>
              <polygon class="axis-arrow" points="200,20 194,32 206,32"/>
              <text class="polaris-label" x="215" y="28">N</text>
              <text fill="var(--text-muted)" font-size="10" x="215" y="380">S</text>
            </g>

            <!-- Selected latitude marker -->
            <g id="latitude-marker">
              <circle id="lat-marker-dot" cx="200" cy="140" r="6" fill="var(--accent-green)" stroke="white" stroke-width="2"/>
              <text id="lat-marker-label" x="220" y="144" fill="var(--accent-green)" font-size="10">40°N</text>
            </g>

            <!-- Latitude band labels -->
            <g id="band-labels" font-size="9" fill="var(--text-muted)">
              <text x="360" y="85" id="label-arctic">Arctic</text>
              <text x="392" y="140" id="label-cancer" text-anchor="end">
                <tspan x="392" dy="0">Tropic of</tspan>
                <tspan x="392" dy="1.2em">Cancer</tspan>
              </text>
              <text x="360" y="205" id="label-equator" fill="var(--accent-green)">Equator</text>
              <text x="392" y="270" id="label-capricorn" text-anchor="end">
                <tspan x="392" dy="0">Tropic of</tspan>
                <tspan x="392" dy="1.2em">Capricorn</tspan>
              </text>
              <text x="360" y="320" id="label-antarctic">Antarctic</text>
            </g>
          </svg>
        </div>
      </div>

      <!-- Controls -->
      <div class="controls-grid">
        <!-- Date control -->
        <div class="control-card">
          <div class="control-title">
            Date (Day of Year)
            <span class="control-value" id="date-slider-display">80</span>
          </div>
          <input type="range" id="date-slider" class="astro-slider" min="1" max="365" value="80" aria-label="Date/Position" data-tooltip-source="#date-slider-display">
          <div class="slider-labels">
            <span>Jan 1</span>
            <span>Apr 1</span>
            <span>Jul 1</span>
            <span>Oct 1</span>
            <span>Dec 31</span>
          </div>

          <!-- Season presets -->
          <div class="presets-section">
            <div class="presets-label">Season Presets</div>
            <div class="presets-row">
              <button class="preset-btn season active" id="preset-mar-equinox" data-day="80">March Equinox</button>
              <button class="preset-btn season" id="preset-jun-solstice" data-day="172">June Solstice</button>
              <button class="preset-btn season" id="preset-sep-equinox" data-day="266">September Equinox</button>
              <button class="preset-btn season" id="preset-dec-solstice" data-day="356">December Solstice</button>
            </div>
          </div>
        </div>

        <!-- Axial tilt control -->
        <div class="control-card">
          <div class="control-title">
            Axial Tilt
            <span class="control-value" id="tilt-display">23.5°</span>
          </div>
          <input type="range" id="tilt-slider" class="astro-slider" min="0" max="90" value="23.5" step="0.1" aria-label="Axial Tilt" data-tooltip-source="#tilt-display">
          <div class="slider-labels">
            <span>0°</span>
            <span>90°</span>
          </div>
        </div>

        <!-- Latitude control -->
        <div class="control-card">
          <div class="control-title">
            Observer Latitude
            <span class="control-value" id="latitude-display">40°N</span>
          </div>
          <input type="range" id="latitude-slider" class="astro-slider" min="-90" max="90" step="0.5" value="40" aria-label="Observer Latitude" data-tooltip-source="#latitude-display">
          <div class="slider-labels">
            <span>90°S</span>
            <span>Equator</span>
            <span>90°N</span>
          </div>
        </div>

        <!-- Animation controls -->
        <div class="control-card">
          <div class="control-title">Animation</div>
          <div class="animation-controls">
            <button class="sim-btn" id="btn-reset-defaults" type="button">Reset to Lecture Defaults</button>
            <button class="sim-btn primary" id="btn-animate-year">Animate Year</button>
            <button class="sim-btn danger" id="btn-stop" disabled>Stop</button>
          </div>
        </div>

        <!-- Overlay toggles -->
        <div class="control-card full-width">
          <div class="control-title">Display Overlays</div>
          <div class="overlays-grid">
            <label class="overlay-toggle">
              <input type="checkbox" id="toggle-celestial-equator">
              Celestial Equator
            </label>
            <label class="overlay-toggle">
              <input type="checkbox" id="toggle-ecliptic">
              Ecliptic
            </label>
            <label class="overlay-toggle">
              <input type="checkbox" id="toggle-latitude-bands" checked>
              Latitude Bands
            </label>
            <label class="overlay-toggle">
              <input type="checkbox" id="toggle-terminator" checked>
              Day/Night Terminator
            </label>
            <label class="overlay-toggle">
              <input type="checkbox" id="toggle-hour-grid">
              Hour Angle Grid
            </label>
          </div>
        </div>
      </div>

      <!-- Insight box -->
      <div class="insight-box">
        <strong>Key misconception addressed:</strong>
        <span class="misconception">"Many people think seasons happen because Earth is closer to the Sun in summer."</span>
        <br><br>
        <strong>This is wrong!</strong> Earth is actually closest to the Sun in January (Northern winter).
        If distance caused seasons, both hemispheres would have summer simultaneously.
        Instead, axial tilt means one hemisphere gets more direct sunlight while the other gets less—creating opposite seasons.
      </div>

      <div class="model-note">
        <strong>Model note:</strong> Not to scale: the orbit eccentricity (distance changes) is exaggerated for visibility. We use a simplified Sun-declination model (good to ~1°), so equinox/solstice timing is approximate.
      </div>

      <!-- Screen reader announcements -->
      <div id="status-announce" aria-live="polite" aria-atomic="true" class="sr-only"></div>
    </div>
  </div>

  <script src="../_assets/astro-utils.js"></script>
  <script src="../_assets/demo-polish.js"></script>
  <script src="../_assets/starfield.js"></script>
  <script src="../_assets/seasons-model.js"></script>
  <script src="seasons.js"></script>
</body>
</html>
